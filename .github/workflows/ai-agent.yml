name: AI Agent (Windows Controlled)

on:
  pull_request:
    types: [labeled]

jobs:
  ai-agent:
    if: github.event.label.name == 'run-opencode'
    runs-on: windows-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Call your AI API
        shell: powershell
        env:
          MY_AI_API_KEY: ${{ secrets.APIKEY }}
        run: |
          $prompt = "Analyze this repo and list files."

          $body = @{
            prompt = $prompt
          } | ConvertTo-Json

          Invoke-RestMethod `
            -Uri "https://vio.automotive-wan.com/" `
            -Method POST `
            -Headers @{ Authorization = "Bearer $env:MY_AI_API_KEY" } `
            -ContentType "application/json" `
            -Body $body
